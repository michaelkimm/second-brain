# 요구사항
돈 이체 시, 앱의 이체 버튼을 두번 클릭하여 같은 이체 요청이 두번 일어나는(=따닥 문제) 상황을 해결 해야함.

<br>
<br>

# 해결 방법
### 방법1. Server side rate limiter 도입
사용자가 앱에서 단건 이체하는데 걸리는 시간은 5초 이상임. 이에 5초 이내에 <출금 계좌, 입금 계좌, 이체 금액>이 같은 이체는 따닥 문제에 해당함. 사용자가 5초 이내에 해당 이체를 요청했었는지 기록하고 있으면 됨. **글로벌 캐시를 둬서 이체 로직 처리 전에 처리한 이체인지 확인** 하면 따닥 문제를 방지할 수 있음. 

#### 장점
- 로직이 간단함.
#### 단점
- Single point of failure(SPOF): 글로벌 캐시가 down된 후 fail over가 되기 전까지 사용자 request는 fail
- 연속 이체 불가능: 토스 증권은 1억원 충전 시, 계좌의 이체 한도가 2000만원이면 5번 연속해서 이체함

<br>

### 방법2. 연속 이체 API와 단건 이체 API 분리
 Serverside rate limiter 방식에서 연속 이체 불가능한 특징을 보완한 방식. 단건 이체 API에서는 Server side rate limiter 방식을 사용. 연속 이체 API는 글로벌 캐시를 거치지 않고 이체를 진행. 단, 연속 이체 API는 앱 or 프론트단이 아닌 다른 서버단에서만 호출이 가능함(따닥 문제 발생x).

 #### 장점
 - 연속 이체 가능
 - 글로벌 캐시로 인한 SPOF x
 #### 단점
 - 추가 API 필요